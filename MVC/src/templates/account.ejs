<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Profile</title>
	<link rel="stylesheet" href="/styles/dist/output.css">
	<link rel="shortcut icon" href="/favicon/favicon.png" type="image/x-icon">
	<script defer src="/scripts/dist/account.js"></script>
</head>

<body class="bg-gray-900 text-white min-h-screen flex flex-col">
	<%- include('components/navbar.ejs') %>
		<main class="flex p-2 gap-8">

			<section class="flex flex-col gap-3 flex-4/5 ml-[16.666%]">

				<article
					class="flex flex-col items-center gap-2 px-4 py-3 bg-gray-800 transition-shadow duration-500 hover:inset-ring hover:inset-ring-indigo-600/70 rounded-md">

					<form action="/account/avatar" , method="POST" enctype="multipart/form-data">
						<label for="avatar" class="cursor-pointer flex flex-col justify-center items-center">
							<%- include('components/errorPopup.ejs') %>
							<img src="/account/avatar" alt="Avatar"
								class="w-32 h-32 rounded-full border-4 border-blue-500 bg-gray-700 mb-1 shadow-lg">
							<span class="text-sm italic">Change avatar (jpeg, gif or png).</span>
							<input type="file" id="avatar" name="avatar" class="hidden">
						</label>
					</form>

					<h1 class="text-3xl font-extrabold text-center">Welcome
						back,
						<span class="text-blue-500">
							<%= user.username %>
						</span>
					</h1>
					<p class="text-xl font-medium">Your latest alias was <span class="text-blue-500">Prueba</span></p>
				</article>

			<article
				class="px-4 py-3 bg-gray-800 transition-shadow duration-500 hover:inset-ring hover:inset-ring-indigo-600/70 rounded-md">
				<h1 class="text-2xl text-left font-extrabold underline underline-offset-3 decoration-2">Your
					latest stats</h1>
				<div class="flex justify-evenly m-2">
					<div class="text-center">
						<p class="text-2xl font-medium">Games Played</p>
						<p class="text-2xl font-medium text-blue-400">
							<%= (profile.victories + profile.defeats) || 0 %>
						</p>
					</div>
					<div class="text-center">
						<p class="text-2xl font-medium">Wins</p>
						<p class="text-2xl font-medium text-green-400">
							<%= profile.victories || 0 %>
						</p>
					</div>
					<div class="text-center">
						<p class="text-2xl font-medium">Losses</p>
						<p class="text-2xl font-medium text-red-400">
							<%= profile.defeats || 0 %>
						</p>
					</div>
				</div>
				<!-- Win Rate -->
				<% const gamesPlayed=(profile.victories + profile.defeats) || 0; %>
				<% const winRateNum=gamesPlayed> 0 ? (profile.victories / gamesPlayed) * 100 : 0; %>
				<% const winRate=winRateNum.toFixed(1); %>
				<div class="mt-4">
					<h3 class="text-lg font-semibold mb-2">Win Rate</h3>
					<div class="bg-gray-700 rounded-full h-4 mb-2">
						<div class="bg-gradient-to-r from-green-400 to-blue-500 h-4 rounded-full transition-all duration-500"
							style="width: <%= winRate %>%;">
						</div>
					</div>
					<p class="text-center text-lg font-semibold">
						<%= winRate %>%
					</p>
				</div>
			</article>
			</section>

			<aside
				class="flex-1/5 px-4 py-3 overflow-auto bg-gray-800 transition-shadow duration-500 hover:inset-ring hover:inset-ring-indigo-600/70 rounded-md">
				<h1 class="text-2xl font-extrabold text-center">Friends</h1>
				<%- include("components/friends.ejs")  %>
			</aside>
		</main>
		<%- include('components/footer.ejs') %>
</body>

</html>